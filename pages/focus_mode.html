<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Focus Mode - StudyMate AI</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
<script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fstudymate8339back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.8"></script>
</head>
<body class="bg-background min-h-screen">
    <!-- Top Navigation -->
    <nav class="bg-surface shadow-sm border-b border-secondary-200 sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo and Brand -->
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                            </svg>
                        </div>
                        <h1 class="text-xl font-semibold text-text-primary">StudyMate AI</h1>
                    </div>
                </div>

                <!-- User Greeting and Profile -->
                <div class="flex items-center space-x-4">
                    <span class="text-text-secondary hidden sm:block">Good afternoon, Alex!</span>
                    <div class="relative">
                        <button id="profileDropdown" class="flex items-center space-x-2 text-text-secondary hover:text-text-primary transition-colors">
                            <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center">
                                <span class="text-sm font-medium text-white">A</span>
                            </div>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        
                        <!-- Dropdown Menu -->
                        <div id="dropdownMenu" class="hidden absolute right-0 mt-2 w-48 bg-surface rounded-lg shadow-floating border border-secondary-200 py-2">
                            <div class="px-4 py-2 border-b border-secondary-200">
                                <p class="text-sm font-medium text-text-primary">Alex Johnson</p>
                                <p class="text-xs text-text-secondary">student@btech.edu</p>
                            </div>
                            <a href="javascript:void(0)" class="block px-4 py-2 text-sm text-text-secondary hover:bg-secondary-50 hover:text-text-primary transition-colors">
                                <i class="fas fa-user mr-2"></i>Profile Settings
                            </a>
                            <a href="login.html" class="block px-4 py-2 text-sm text-text-secondary hover:bg-secondary-50 hover:text-text-primary transition-colors">
                                <i class="fas fa-sign-out-alt mr-2"></i>Logout
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="flex min-h-screen">
        <!-- Left Sidebar -->
        <aside class="w-64 bg-surface shadow-sm border-r border-secondary-200">
            <nav class="mt-6 px-4">
                <ul class="space-y-2">
                    <li>
                        <a href="dashboard.html" class="flex items-center px-4 py-3 text-text-secondary hover:bg-secondary-50 hover:text-text-primary rounded-lg transition-colors">
                            <i class="fas fa-home mr-3"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="my_notes.html" class="flex items-center px-4 py-3 text-text-secondary hover:bg-secondary-50 hover:text-text-primary rounded-lg transition-colors">
                            <i class="fas fa-sticky-note mr-3"></i>
                            <span>My Notes</span>
                        </a>
                    </li>
                    <li>
                        <a href="coding_and_projects.html" class="flex items-center px-4 py-3 text-text-secondary hover:bg-secondary-50 hover:text-text-primary rounded-lg transition-colors">
                            <i class="fas fa-code mr-3"></i>
                            <span>Coding & Projects</span>
                        </a>
                    </li>
                    <li>
                        <a href="my_schedule.html" class="flex items-center px-4 py-3 text-text-secondary hover:bg-secondary-50 hover:text-text-primary rounded-lg transition-colors">
                            <i class="fas fa-calendar mr-3"></i>
                            <span>My Schedule</span>
                        </a>
                    </li>
                    <li>
                        <a href="focus_mode.html" class="flex items-center px-4 py-3 bg-primary-50 text-primary rounded-lg">
                            <i class="fas fa-brain mr-3"></i>
                            <span>Focus Mode</span>
                            <div class="ml-auto w-2 h-2 bg-primary rounded-full"></div>
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- Progress Widget -->
            <div class="mt-8 mx-4 p-4 bg-accent-50 rounded-lg border border-accent-100">
                <h3 class="text-sm font-medium text-accent-600 mb-2">Total Progress</h3>
                <div class="space-y-2">
                    <div class="flex justify-between text-xs">
                        <span class="text-accent-600">Focus Points</span>
                        <span class="font-medium text-accent-600" id="totalFocusPoints">1,247</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span class="text-accent-600">Coding Points</span>
                        <span class="font-medium text-accent-600">892</span>
                    </div>
                    <div class="progress-bar h-2 mt-2">
                        <div class="progress-fill" style="width: 68%"></div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-6">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-text-primary mb-2">Focus Mode</h1>
                <p class="text-text-secondary">Enhance your concentration and earn points through focused study sessions</p>
            </div>

            <!-- Focus Timer Section -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <!-- Main Timer Card -->
                <div class="lg:col-span-2">
                    <div class="card p-8 text-center">
                        <!-- Timer Display -->
                        <div class="mb-8">
                            <div class="relative inline-block">
                                <svg class="w-64 h-64 transform -rotate-90" viewBox="0 0 256 256">
                                    <circle cx="128" cy="128" r="112" fill="none" stroke="#E2E8F0" stroke-width="8"/>
                                    <circle id="progressCircle" cx="128" cy="128" r="112" fill="none" stroke="#2563EB" stroke-width="8" stroke-linecap="round" stroke-dasharray="703.7" stroke-dashoffset="703.7" class="transition-all duration-1000"/>
                                </svg>
                                <div class="absolute inset-0 flex flex-col items-center justify-center">
                                    <div class="text-5xl font-bold text-text-primary mb-2" id="timerDisplay">00:00:00</div>
                                    <div class="text-text-secondary text-sm">Focus Time</div>
                                </div>
                            </div>
                        </div>

                        <!-- Timer Controls -->
                        <div class="flex justify-center space-x-4 mb-6">
                            <button id="startBtn" class="btn-primary px-8 py-3 text-lg rounded-xl shadow-md hover:shadow-lg transition-all">
                                <i class="fas fa-play mr-2"></i>Start Focus
                            </button>
                            <button id="pauseBtn" class="btn-secondary px-8 py-3 text-lg rounded-xl shadow-md hover:shadow-lg transition-all hidden">
                                <i class="fas fa-pause mr-2"></i>Pause
                            </button>
                            <button id="stopBtn" class="bg-error-600 text-white px-8 py-3 text-lg rounded-xl shadow-md hover:bg-error-700 hover:shadow-lg transition-all hidden">
                                <i class="fas fa-stop mr-2"></i>Stop
                            </button>
                        </div>

                        <!-- Points Display -->
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-accent-50 rounded-lg p-4">
                                <div class="text-2xl font-bold text-accent-600" id="sessionPoints">0</div>
                                <div class="text-sm text-accent-600">Session Points</div>
                            </div>
                            <div class="bg-primary-50 rounded-lg p-4">
                                <div class="text-2xl font-bold text-primary-600">1 pt / 2 min</div>
                                <div class="text-sm text-primary-600">Point Rate</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Session Configuration -->
                <div class="space-y-6">
                    <!-- Target Duration -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-text-primary mb-4">Session Settings</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-text-primary mb-2">Target Duration</label>
                                <select id="targetDuration" class="input-field">
                                    <option value="1500">25 minutes</option>
                                    <option value="3000">50 minutes</option>
                                    <option value="4500">75 minutes</option>
                                    <option value="5400">90 minutes</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-text-primary mb-2">Study Subject</label>
                                <select id="studySubject" class="input-field">
                                    <option value="general">General Study</option>
                                    <option value="programming">Programming</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="physics">Physics</option>
                                    <option value="chemistry">Chemistry</option>
                                    <option value="project">Project Work</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-text-primary mb-2">Break Interval</label>
                                <select id="breakInterval" class="input-field">
                                    <option value="300">5 minutes</option>
                                    <option value="600">10 minutes</option>
                                    <option value="900">15 minutes</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Ambient Controls -->
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold text-text-primary mb-4">Ambient Controls</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-text-primary mb-2">Background Sound</label>
                                <select id="ambientSound" class="input-field">
                                    <option value="none">None</option>
                                    <option value="rain">Rain</option>
                                    <option value="forest">Forest</option>
                                    <option value="cafe">Café</option>
                                    <option value="white-noise">White Noise</option>
                                </select>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium text-text-primary">Block Distractions</span>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="blockDistractions" class="sr-only peer" />
                                    <div class="w-11 h-6 bg-secondary-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-secondary-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Session History -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Recent Sessions -->
                <div class="card p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-text-primary">Recent Sessions</h3>
                        <button class="text-primary hover:text-primary-700 text-sm font-medium">View All</button>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-secondary-50 rounded-lg">
                            <div>
                                <div class="font-medium text-text-primary">Programming</div>
                                <div class="text-sm text-text-secondary">Today, 2:30 PM</div>
                            </div>
                            <div class="text-right">
                                <div class="font-medium text-accent-600">45 min</div>
                                <div class="text-sm text-text-secondary">22 pts</div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-secondary-50 rounded-lg">
                            <div>
                                <div class="font-medium text-text-primary">Mathematics</div>
                                <div class="text-sm text-text-secondary">Today, 10:15 AM</div>
                            </div>
                            <div class="text-right">
                                <div class="font-medium text-accent-600">30 min</div>
                                <div class="text-sm text-text-secondary">15 pts</div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-secondary-50 rounded-lg">
                            <div>
                                <div class="font-medium text-text-primary">Project Work</div>
                                <div class="text-sm text-text-secondary">Yesterday, 4:45 PM</div>
                            </div>
                            <div class="text-right">
                                <div class="font-medium text-accent-600">60 min</div>
                                <div class="text-sm text-text-secondary">30 pts</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Achievements -->
                <div class="card p-6">
                    <h3 class="text-lg font-semibold text-text-primary mb-4">Achievements</h3>
                    <div class="space-y-4">
                        <div class="flex items-center space-x-3 p-3 bg-accent-50 rounded-lg">
                            <div class="w-12 h-12 bg-accent-500 rounded-full flex items-center justify-center">
                                <i class="fas fa-fire text-white text-lg"></i>
                            </div>
                            <div>
                                <div class="font-medium text-accent-600">7-Day Streak</div>
                                <div class="text-sm text-text-secondary">Focused for 7 consecutive days</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-primary-50 rounded-lg">
                            <div class="w-12 h-12 bg-primary-500 rounded-full flex items-center justify-center">
                                <i class="fas fa-clock text-white text-lg"></i>
                            </div>
                            <div>
                                <div class="font-medium text-primary-600">100 Hours</div>
                                <div class="text-sm text-text-secondary">Total focus time milestone</div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-warning-50 rounded-lg">
                            <div class="w-12 h-12 bg-warning-600 rounded-full flex items-center justify-center">
                                <i class="fas fa-trophy text-white text-lg"></i>
                            </div>
                            <div>
                                <div class="font-medium text-warning-600">Focus Master</div>
                                <div class="text-sm text-text-secondary">Completed 50 focus sessions</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics Overview -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="card p-6 text-center">
                    <div class="text-3xl font-bold text-primary-600 mb-2">127</div>
                    <div class="text-sm text-text-secondary">Total Sessions</div>
                </div>
                <div class="card p-6 text-center">
                    <div class="text-3xl font-bold text-accent-600 mb-2">89.5h</div>
                    <div class="text-sm text-text-secondary">Total Focus Time</div>
                </div>
                <div class="card p-6 text-center">
                    <div class="text-3xl font-bold text-warning-600 mb-2">42min</div>
                    <div class="text-sm text-text-secondary">Average Session</div>
                </div>
                <div class="card p-6 text-center">
                    <div class="text-3xl font-bold text-error-600 mb-2">7</div>
                    <div class="text-sm text-text-secondary">Current Streak</div>
                </div>
            </div>
        </main>
    </div>

    <!-- AI Chatbot -->
    <div class="floating-action" id="chatbotToggle">
        <i class="fas fa-robot text-xl"></i>
    </div>

    <!-- Session Active Indicator -->
    <div id="sessionIndicator" class="hidden fixed top-20 right-6 bg-accent-500 text-white px-4 py-2 rounded-lg shadow-lg">
        <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-white rounded-full animate-pulse"></div>
            <span class="text-sm font-medium">Focus Session Active</span>
        </div>
    </div>

    <!-- Break Notification -->
    <div id="breakNotification" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-surface rounded-lg p-8 max-w-md mx-4 text-center">
            <div class="w-16 h-16 bg-accent-500 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-coffee text-white text-2xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-text-primary mb-2">Time for a Break!</h3>
            <p class="text-text-secondary mb-6">You've been focusing for a while. Take a 5-minute break to recharge.</p>
            <div class="flex space-x-3">
                <button id="takeBreakBtn" class="btn-primary flex-1">Take Break</button>
                <button id="continueBtn" class="btn-secondary flex-1">Continue</button>
            </div>
        </div>
    </div>

    <script>
        // Timer functionality
        let timerInterval;
        let startTime;
        let elapsedTime = 0;
        let isRunning = false;
        let sessionPoints = 0;
        let totalFocusPoints = parseInt(localStorage.getItem('totalFocusPoints')) || 1247;

        const timerDisplay = document.getElementById('timerDisplay');
        const progressCircle = document.getElementById('progressCircle');
        const sessionPointsDisplay = document.getElementById('sessionPoints');
        const totalFocusPointsDisplay = document.getElementById('totalFocusPoints');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const stopBtn = document.getElementById('stopBtn');
        const sessionIndicator = document.getElementById('sessionIndicator');

        // Profile dropdown
        document.getElementById('profileDropdown').addEventListener('click', function() {
            document.getElementById('dropdownMenu').classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('dropdownMenu');
            const button = document.getElementById('profileDropdown');
            if (!button.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });

        // Timer functions
        function formatTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function updateTimer() {
            const currentTime = Date.now();
            elapsedTime = Math.floor((currentTime - startTime) / 1000);
            
            timerDisplay.textContent = formatTime(elapsedTime);
            
            // Update progress circle
            const targetDuration = parseInt(document.getElementById('targetDuration').value);
            const progress = Math.min(elapsedTime / targetDuration, 1);
            const circumference = 703.7;
            const offset = circumference - (progress * circumference);
            progressCircle.style.strokeDashoffset = offset;
            
            // Calculate points (1 point per 2 minutes = 120 seconds)
            sessionPoints = Math.floor(elapsedTime / 120);
            sessionPointsDisplay.textContent = sessionPoints;
            
            // Check for break notification
            if (elapsedTime > 0 && elapsedTime % 1800 === 0) { // Every 30 minutes
                showBreakNotification();
            }
        }

        function startTimer() {
            if (!isRunning) {
                startTime = Date.now() - (elapsedTime * 1000);
                timerInterval = setInterval(updateTimer, 1000);
                isRunning = true;
                
                startBtn.classList.add('hidden');
                pauseBtn.classList.remove('hidden');
                stopBtn.classList.remove('hidden');
                sessionIndicator.classList.remove('hidden');
            }
        }

        function pauseTimer() {
            if (isRunning) {
                clearInterval(timerInterval);
                isRunning = false;
                
                startBtn.classList.remove('hidden');
                pauseBtn.classList.add('hidden');
                sessionIndicator.classList.add('hidden');
                
                startBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Resume';
            }
        }

        function stopTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            
            // Add session points to total
            totalFocusPoints += sessionPoints;
            localStorage.setItem('totalFocusPoints', totalFocusPoints);
            totalFocusPointsDisplay.textContent = totalFocusPoints.toLocaleString();
            
            // Save session to history
            saveSession();
            
            // Reset UI
            elapsedTime = 0;
            sessionPoints = 0;
            timerDisplay.textContent = '00:00:00';
            sessionPointsDisplay.textContent = '0';
            progressCircle.style.strokeDashoffset = '703.7';
            
            startBtn.classList.remove('hidden');
            pauseBtn.classList.add('hidden');
            stopBtn.classList.add('hidden');
            sessionIndicator.classList.add('hidden');
            
            startBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Start Focus';
        }

        function saveSession() {
            const sessions = JSON.parse(localStorage.getItem('focusSessions')) || [];
            const session = {
                date: new Date().toISOString(),
                duration: elapsedTime,
                points: sessionPoints,
                subject: document.getElementById('studySubject').value
            };
            sessions.unshift(session);
            sessions.splice(10); // Keep only last 10 sessions
            localStorage.setItem('focusSessions', JSON.stringify(sessions));
        }

        function showBreakNotification() {
            document.getElementById('breakNotification').classList.remove('hidden');
        }

        // Event listeners
        startBtn.addEventListener('click', startTimer);
        pauseBtn.addEventListener('click', pauseTimer);
        stopBtn.addEventListener('click', stopTimer);

        // Break notification handlers
        document.getElementById('takeBreakBtn').addEventListener('click', function() {
            pauseTimer();
            document.getElementById('breakNotification').classList.add('hidden');
        });

        document.getElementById('continueBtn').addEventListener('click', function() {
            document.getElementById('breakNotification').classList.add('hidden');
        });

        // Chatbot toggle
        document.getElementById('chatbotToggle').addEventListener('click', function() {
            alert('AI Chatbot: Hi! I can help you with study tips and focus techniques. What would you like to know?');
        });

        // Background operation support
        document.addEventListener('visibilitychange', function() {
            if (document.hidden && isRunning) {
                // Timer continues running in background
                console.log('Focus session continues in background');
            } else if (!document.hidden && isRunning) {
                // Update timer when page becomes visible again
                updateTimer();
            }
        });

        // Initialize total points display
        totalFocusPointsDisplay.textContent = totalFocusPoints.toLocaleString();

        // Ambient sound simulation
        document.getElementById('ambientSound').addEventListener('change', function() {
            const sound = this.value;
            if (sound !== 'none') {
                console.log(`Playing ${sound} ambient sound`);
                // In a real app, this would control audio playback
            }
        });

        // Block distractions toggle
        document.getElementById('blockDistractions').addEventListener('change', function() {
            if (this.checked) {
                console.log('Distraction blocking enabled');
                // In a real app, this would implement website/app blocking
            } else {
                console.log('Distraction blocking disabled');
            }
        });
    </script>
</body>
</html>